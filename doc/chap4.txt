  
  [1X4 [33X[0;0YMappings, transformations and permutations of right quasigroups[133X[101X
  
  
  [1X4.1 [33X[0;0YMappings, transformations and permutations[133X[101X
  
  [33X[0;0YGiven right quasigroups [10XQ1[110X and [10XQ2[110X, a mapping from [10XQ1[110X to [10XQ2[110X is represented in
  one of the following ways:[133X
  
  [30X    [33X[0;6Yas  a  [5XGAP[105X  mapping  with  source  [10XQ1[110X  and range [10XQ2[110X (used for mappings
        between   two   distinct   right   quasigroups,   for   instance   for
        homomorphisms),[133X
  
  [30X    [33X[0;6Yas  a transformation (a numerical analog of [5XGAP[105X mappings, for instance
        for left translations of right quasigroups),[133X
  
  [30X    [33X[0;6Yas  a  permutation  (used  for  bijective  mappings  when [10XQ1 = Q2[110X, for
        instance for translations in quasigroups, automorphisms, etc.).[133X
  
  [33X[0;0YMoreveor,  for a fixed right quasigroup [10XQ[110X, permutations can be understood in
  two ways:[133X
  
  [30X    [33X[0;6Y[13XParent  permutations[113X, whose indexing is based on the parent indices of
        elements of [10XQ[110X. More precisely, a permutation [10Xf[110X is a parent permutation
        of [10XQ[110X if it restricts to a permutation of the set [10XParentInd( Q )[110X. (Note
        that  it is not required for [10Xf[110X to fix all points outside of [10XParentInd(
        Q )[110X.)[133X
  
  [30X    [33X[0;6Y[13XCanonical  permutations[113X,  whose  indexing  is based on the position of
        elements  among  elements  of  [10XQ[110X. More precisely, a permutation [10Xf[110X is a
        canonical  permutation  on  [10XQ[110X  if  it  restricts  to  a permutation on
        [10X[1..Size(Q)][110X.  (Note  that  it is not required for [10Xf[110X to fix all points
        outside  of  [10X[1..Size(Q)][110X,  not  even  to  fix  all  points outside of
        [10X[1..Size(Parent(Q))][110X.)[133X
  
  [33X[0;0YA  permutation  does  not keep track of [10XQ[110X, of course. The right quasigroup [10XQ[110X
  must  therefore  be  provided  in  order  to  construct a [5XGAP[105X mapping from a
  permutation.[133X
  
  [33X[0;0YSimilarly,  for  fixed  right  quasigroups  [10XQ1[110X,  [10XQ2[110X,  transformations can be
  understood in two ways:[133X
  
  [30X    [33X[0;6Y[13XParent  transformations[113X, whose indexing is based on the parent indices
        of  elements  of  [10XQ1[110X  and  [10XQ2[110X. More precisely, a transformation [10Xt[110X is a
        parent  transformation from [10XQ1[110X to [10XQ2[110X if for every [10Xi[110X in [10XParentInt( Q1 )[110X
        we have [10Xi^t[110X in [10XParentInd( Q2 )[110X.[133X
  
  [30X    [33X[0;6Y[13XCanonical  transformations[113X, whose indexing is based on the position of
        elements among elements of [10XQ1[110X and [10XQ2[110X. More precisely, a transformation
        [10Xt[110X  is  a  canonical  transformation  from  [10XQ1[110X  to [10XQ2[110X if for every [10Xi[110X in
        [10X[1..Size(Q1)][110X we have [10Xi^t[110X in [10X[1..Size(Q2)][110X.[133X
  
  [33X[0;0YA  transformation does not keep track of [10XQ1[110X and [10XQ2[110X. The right quasigroups [10XQ1[110X
  and [10XQ2[110X must therefore be provided in order to construct a [5XGAP[105X mapping from a
  transformation.[133X
  
  [33X[0;0YWhenever  possible,  [5XRightQuasigroups[105X  works  with  parent  permutations  as
  default mappings, such as for right translations of quasigroups, right inner
  mappings  of quasigroups, automorphisms, etc. The default permutation action
  in  [5XRightQuasigroups[105X treats permutations as parent permutations, that is, if
  [10XQ[110X is a right quasigroup and [10Xf[110X is a permutation then [10X(Q.i)^f[110X returns [10XQ.(i^f)[110X.[133X
  
  [33X[0;0YWhen the mapping is not bijective or the source and target are not the same,
  the default option is a parent transformation.[133X
  
  [33X[0;0YCanonical  permutations and canonical transformations are quite useful, too,
  for instance while working with multiplication tables.[133X
  
  [33X[0;0YThe  following example shows all possible conversions between the 5 types of
  bijective mappings in the situation when the source and target are the same.
  All  details concerning the conversion functions and their arguments as well
  as  additional  examples  will  be  given  later. Note that the standard [5XGAP[105X
  method  [10XAsPermutation[110X  can be used to convert a transformation (that happens
  to  permute  its  image)  into  a permutation, while the standard [5XGAP[105X method
  [10XAsTransformation[110X   can   be   used   to   convert  any  permutation  into  a
  transformation.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQ := MoufangLoop( 12, 1 );;[127X[104X
    [4X[25Xgap>[125X [27XS := Subloop( Q, [Q.3] );[127X[104X
    [4X[28X<Moufang loop of size 3>[128X[104X
    [4X[25Xgap>[125X [27XParentInd( S ); # indices of S in Q[127X[104X
    [4X[28X[ 1, 3, 5 ][128X[104X
    [4X[25Xgap>[125X [27Xf := LeftTranslation( S, S.3 ); # automatically returned as a parent permutation[127X[104X
    [4X[28X(1,3,5)[128X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27X# CONVERTING PARENT PERMUTATIONS[127X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27XAsCanonicalPerm( S, f );[127X[104X
    [4X[28X(1,2,3)[128X[104X
    [4X[25Xgap>[125X [27XAsTransformation( f ); # standard GAP function[127X[104X
    [4X[28XTransformation( [ 3, 2, 5, 4, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsCanonicalTransformation( S, f );[127X[104X
    [4X[28XTransformation( [ 2, 3, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsRightQuasigroupMapping( S, f ); # parent permutation expected by default[127X[104X
    [4X[28XMappingByFunction( <Moufang loop of size 3>, <Moufang loop of size 3>,\[128X[104X
    [4X[28X function( x ) ... end )[128X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27X# CONVERTING CANONICAL PERMUTATIONS[127X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27Xg := (1,2,3);;[127X[104X
    [4X[25Xgap>[125X [27XAsParentPerm( S, g );[127X[104X
    [4X[28X(1,3,5)[128X[104X
    [4X[25Xgap>[125X [27XAsTransformation( g ); # standard GAP function[127X[104X
    [4X[28XTransformation( [ 2, 3, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsParentTransformation( S, g );[127X[104X
    [4X[28XTransformation( [ 3, 2, 5, 4, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsRightQuasigroupMapping( S, g, true ); # optional bool needed for canonical[127X[104X
    [4X[28XMappingByFunction( <Moufang loop of size 3>, <Moufang loop of size 3>,\[128X[104X
    [4X[28X function( x ) ... end )[128X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27X# CONVERTING PARENT TRANSFORMATIONS[127X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27Xh := Transformation( [3,2,5,4,1] );;[127X[104X
    [4X[25Xgap>[125X [27XAsPermutation( h ); # standard GAP function[127X[104X
    [4X[28X(1,3,5)[128X[104X
    [4X[25Xgap>[125X [27XAsCanonicalPerm( S, h );[127X[104X
    [4X[28X(1,2,3)[128X[104X
    [4X[25Xgap>[125X [27XAsCanonicalTransformation( S, S, h );[127X[104X
    [4X[28XTransformation( [ 2, 3, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsRightQuasigroupMapping( S, S, h ); # parent transformation expected by default[127X[104X
    [4X[28XMappingByFunction( <Moufang loop of size 3>, <Moufang loop of size 3>,\[128X[104X
    [4X[28X function( x ) ... end )[128X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27X# CONVERTING CANONICAL TRANSFORMATIONS[127X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27Xk := Transformation( [ 2, 3, 1 ] );;[127X[104X
    [4X[25Xgap>[125X [27XAsPermutation( k ); # default GAP function[127X[104X
    [4X[28X(1,2,3)[128X[104X
    [4X[25Xgap>[125X [27XAsParentPerm( S, k );[127X[104X
    [4X[28X(1,3,5)[128X[104X
    [4X[25Xgap>[125X [27XAsParentTransformation( S, S, k );[127X[104X
    [4X[28XTransformation( [ 3, 2, 5, 4, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsRightQuasigroupMapping( S, S, k, true ); # optional bool needed for canonical[127X[104X
    [4X[28XMappingByFunction( <Moufang loop of size 3>, <Moufang loop of size 3>,\[128X[104X
    [4X[28X function( x ) ... end )[128X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27X# CONVERTING RIGHT QUASIGROUP MAPPINGS[127X[104X
    [4X[25Xgap>[125X [27X#[127X[104X
    [4X[25Xgap>[125X [27Xm := last;;[127X[104X
    [4X[25Xgap>[125X [27XAsParentPerm( m );[127X[104X
    [4X[28X(1,3,5)[128X[104X
    [4X[25Xgap>[125X [27XAsCanonicalPerm( m );[127X[104X
    [4X[28X(1,2,3)[128X[104X
    [4X[25Xgap>[125X [27XAsParentTransformation( m );[127X[104X
    [4X[28XTransformation( [ 3, 2, 5, 4, 1 ] )[128X[104X
    [4X[25Xgap>[125X [27XAsCanonicalTransformation( m );[127X[104X
    [4X[28XTransformation( [ 2, 3, 1 ] )[128X[104X
  [4X[32X[104X
  
  
  [1X4.2 [33X[0;0YRight quasigroup mapppings[133X[101X
  
  [33X[0;0YMappings  between  right quasigroups are [5XGAP[105X mappings - the standard methods
  for  mappings  therefore  apply.  The following example creates the squaring
  mapping on a loop [10XQ[110X and calculates the image of an element of [10XQ[110X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQ := MoufangLoop( 12, 1 );;[127X[104X
    [4X[25Xgap>[125X [27Xm := MappingByFunction( Q, Q, x -> x*x );[127X[104X
    [4X[28XMappingByFunction( MoufangLoop( 12, 1 ), MoufangLoop( 12, 1 ), functio\[128X[104X
    [4X[28Xn( x ) ... end )[128X[104X
    [4X[25Xgap>[125X [27X[ Source( m ) = Q, Range( m ) = Q ];[127X[104X
    [4X[28X[ true, true ][128X[104X
    [4X[25Xgap>[125X [27XQ.2*Q.2 = Q.2^m;[127X[104X
    [4X[28Xtrue[128X[104X
  [4X[32X[104X
  
  
  [1X4.2-1 [33X[0;0YIsRightQuasigroupMapping, IsQuasigroupMapping, IsLoopMapping[133X[101X
  
  [33X[1;0Y[29X[2XIsRightQuasigroupMapping[102X( [3Xm[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XIsQuasigroupMapping[102X( [3Xm[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XIsLoopMapping[102X( [3Xm[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Y[10Xtrue[110X  if  [3Xm[103X is a right quasigroup (quasigroup, loop) mapping, that
            is, a [5XGAP[105X mapping in which both the source and the range are right
            quasigroups (quasigroups, loops).[133X
  
  [1X4.2-2 AsRightQuasigroupMapping[101X
  
  [33X[1;0Y[29X[2XAsRightQuasigroupMapping[102X( [3XQ1[103X, [3XQ2[103X, [3Xf[103X[, [3XisCanonical[103X] ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10YIn  this  form,  returns a right quasigroup mapping with source [3XQ1[103X
            and  range  [3XQ2[103X determined by the transformation [3Xf[103X. If the optional
            argument  is  not  given,  it  is  checked  that  [3Xf[103X  is  a  parent
            transformation  from  [10XQ1[110X  to  [10XQ2[110X,  and then the returned mapping [10Xm[110X
            satisfies  [10X(Q1.i)^m  = Q2.j[110X iff [10Xi^f=j[110X. If the optional argument is
            set  to  [10Xtrue[110X, is it checked that [3Xf[103X is a canonical transformation,
            and  then  the  returned mapping [10Xm[110X satisfies [10X(Elements(Q1)[i])^m =
            Elements(Q2)[j][110X iff [10Xi^f=j[110X.[133X
  
  [33X[0;0YIn the form [10XAsRightQuasigroupMapping( [110X[3XQ[103X[10X, [110X[3Xf[103X[10X[, [110X[3XisCanonical[103X[10X] )[110X, returns a right
  quasigroup  mapping  with  source  and  range  equal to [3XQ[103X, determined by the
  permutation [3Xf[103X.[133X
  
  
  [1X4.3 [33X[0;0YCanonical permutations and parent permutations[133X[101X
  
  [1X4.3-1 IsCanonicalPerm[101X
  
  [33X[1;0Y[29X[2XIsCanonicalPerm[102X( [3XQ[103X, [3Xf[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Y[10Xtrue[110X  if the permutation [3Xf[103X is a canonical permutation on the right
            quasigroup  [3XQ[103X,  (that  is,  if  [3Xf[103X  restricts  to  a permutation of
            [10X[1..Size([110X[3XQ[103X[10X)][110X), else returns [10Xfalse[110X.[133X
  
  [1X4.3-2 IsParentPerm[101X
  
  [33X[1;0Y[29X[2XIsParentPerm[102X( [3XQ[103X, [3Xf[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Y[10Xtrue[110X  if [3Xf[103X is a parent permutation on right quasigroup [10XQ[110X (that is,
            if  [3Xf[103X  restricts  to  a permutation of the set [10XParentInd([110X[3XQ[103X[10X)[110X), else
            returns [10Xfalse[110X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQ := MoufangLoop( 12, 1 );; S := Subloop( Q, [Q.3] );;[127X[104X
    [4X[25Xgap>[125X [27XParentInd( S );[127X[104X
    [4X[28X[ 1, 3, 5 ][128X[104X
    [4X[25Xgap>[125X [27X(Q.3)^(3,4) = Q.4;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsParentPerm( S, (3,4) ); # does not act on [ 1, 3, 5 ] [127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XIsParentPerm( S, (3,5) ); # acts on [ 1, 3, 5 ][127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsParentPerm( S, (3,5)(7,8) ); # behavior outside of S is ignored[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsCanonicalPerm( S, (1,2,3) ); # acts on [1..Size(S)][127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsCanonicalPerm( S, (1,3,5) ); # does not act on [1..Size(S)][127X[104X
    [4X[28Xfalse[128X[104X
  [4X[32X[104X
  
  [1X4.3-3 AsCanonicalPerm[101X
  
  [33X[1;0Y[29X[2XAsCanonicalPerm[102X( [3Xarg[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ythe  canonical  permutation  determined by the argument(s) [3Xarg[103X. If
            the argument is a bijective right quasigroup mapping [10Xm[110X with source
            [10XQ1[110X  and  range  [10XQ2[110X,  returns  a  permutation [10Xf[110X such that [10Xi^f=j[110X iff
            [10XElements(Q1)[i]^m  = Elements(Q2)[j][110X. If the arguments are a right
            quasigroup  [10XQ[110X and its bijective parent transformation [10Xm[110X, returns a
            permutation   [10Xf[110X   such   that   [10Xi^f=j[110X   iff   [10XParentInd(Q)[i]^m  =
            ParentInd(Q)[j][110X. If the arguments are a right quasigroup [10XQ[110X and its
            parent  permutation [10Xm[110X, returns a permutation [10Xf[110X such that [10Xi^f=j[110X iff
            [10XParentInd(Q)[i]^m = ParentInd(Q)[j][110X.[133X
  
  [1X4.3-4 AsParentPerm[101X
  
  [33X[1;0Y[29X[2XAsParentPerm[102X( [3Xarg[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ythe  parent  permutation determined by the argument(s) [3Xarg[103X. If the
            argument is a bijective right quasigroup mapping [10Xm[110X on [10XQ[110X, returns a
            permutation  [10Xf[110X  such  that  [10Xi^f=j[110X  iff  [10X(Q.i)^m  =  Q.j[110X  (for [10Xi[110X in
            [10XParentInd(Q)[110X).  If  the arguments are a right quasigroup [10XQ[110X and its
            bijective canonical transformation [10Xm[110X, returns a permutation [10Xf[110X such
            that   [10XParentInd(Q)[i]^f=ParentInd(Q)[j][110X  iff  [10Xi^m  =  j[110X.  If  the
            arguments  are  a right quasigroup [10XQ[110X and its canonical permutation
            [10Xm[110X,      returns      a      permutation      [10Xf[110X      such      that
            [10XParentInd(Q)[i]^f=ParentInd(Q)[j][110X iff [10Xi^m = j[110X.[133X
  
  [33X[0;0YSee [10XParentInd[110X, too.[133X
  
  
  [1X4.4 [33X[0;0YCanonical transformations and parent transformations[133X[101X
  
  [1X4.4-1 IsCanonicalTransformation[101X
  
  [33X[1;0Y[29X[2XIsCanonicalTransformation[102X( [3XQ1[103X, [3XQ2[103X, [3Xt[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Y[10Xtrue[110X  if  [3Xt[103X is a canonical transformation from right quasigroup [3XQ1[103X
            to  right  quasigroup  [3XQ2[103X, that is, if [10Xi^f[110X is in [10X[1..Size(Q2)][110X for
            all [10Xi[110X in [10X[1..Size(Q1)][110X.[133X
  
  [1X4.4-2 IsParentTransformation[101X
  
  [33X[1;0Y[29X[2XIsParentTransformation[102X( [3XQ1[103X, [3XQ2[103X, [3Xt[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Y[10Xtrue[110X  if  [3Xt[103X is a parent transformation from right quasigroup [3XQ1[103X to
            right quasigroup [3XQ2[103X (that is, if [10Xi^f[110X is in [10XParentInd( Q2 )[110X for all
            [10Xi[110X in [10XParentInd( Q1 )[110X), else returns [10Xfalse[110X.[133X
  
  [1X4.4-3 AsCanonicalTransformation[101X
  
  [33X[1;0Y[29X[2XAsCanonicalTransformation[102X( [3Xarg[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ythe canonical transformation determined by the argument(s) [3Xarg[103X. If
            the  argument  is  a right quasigroup mapping [10Xm[110X with source [10XQ1[110X and
            range   [10XQ2[110X,  returns  a  transformation  [10Xt[110X  such  that  [10Xi^t=j[110X  iff
            [10XElements(Q1)[i]^m  =  Elements(Q2)[j][110X.  If  the  arguments are two
            right  quasigroups  [10XQ1[110X,  [10XQ2[110X  and  their  parent  transformation [10Xm[110X,
            returns a tranformation [10Xt[110X such that [10Xi^t=j[110X iff [10XParentInd(Q1)[i]^m =
            ParentInd(Q2)[j][110X.  If  the  arguments are a right quasigroup [10XQ[110X and
            its  parent  permutation  [10Xm[110X,  returns  a tranformation [10Xt[110X such that
            [10Xi^t=j[110X iff [10XParentInd(Q)[i]^m = ParentInd(Q)[j][110X.[133X
  
  [1X4.4-4 AsParentTransformation[101X
  
  [33X[1;0Y[29X[2XAsParentTransformation[102X( [3Xarg[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ythe  parent  transformation  determined by the argument(s) [3Xarg[103X. If
            the  argument  is  a right quasigroup mapping [10Xm[110X with source [10XQ1[110X and
            range  [10XQ2[110X, returns a transformation [10Xt[110X such that [10Xi^t=j[110X iff [10X(Q1.i)^m
            =  Q2.j[110X  (for  [10Xi[110X in [10XParentInd(Q1)[110X). If the arguments are two right
            quasigroups [10XQ1[110X, [10XQ2[110X and their canonical transformation [10Xm[110X, returns a
            tranformation  [10Xt[110X such that [10XParentInd(Q1)[i]^t=ParentInd(Q2)[j][110X iff
            [10Xi^m  =  j[110X.  If  the  arguments  are  a  right quasigroup [10XQ[110X and its
            canonical  permutation  [10Xm[110X,  returns  a  tranformation  [10Xt[110X such that
            [10XParentInd(Q)[i]^t=ParentInd(Q)[j][110X iff [10Xi^m = j[110X.[133X
  
  [33X[0;0YSee [10XParentInd[110X, too.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQ := AsLoop( SymmetricGroup( 4 ) );;[127X[104X
    [4X[25Xgap>[125X [27XS1 := Subloop( Q, [ Q[(1,2,3)] ] );;[127X[104X
    [4X[25Xgap>[125X [27XS2 := Subloop( Q, [ Q[(1,4)]*Q[(1,2,3)]*Q[(1,4)] ] );; # conjugate subloop[127X[104X
    [4X[25Xgap>[125X [27Xm := MappingByFunction( S1, S2, x-> Q[(1,4)]*x*Q[(1,4)] ); # conjugation S1 -> S2[127X[104X
    [4X[28XMappingByFunction( <associative loop of size 3>, <associative loop of \[128X[104X
    [4X[28Xsize 3>, function( x ) ... end )[128X[104X
    [4X[25Xgap>[125X [27XParentInd( S1 );[127X[104X
    [4X[28X[ 1, 9, 13 ][128X[104X
    [4X[25Xgap>[125X [27XParentInd( S2 );[127X[104X
    [4X[28X[ 1, 4, 5 ][128X[104X
    [4X[25Xgap>[125X [27Xt := AsParentTransformation( m ); [127X[104X
    [4X[28XTransformation( [ 1, 2, 3, 4, 5, 6, 7, 8, 4, 10, 11, 12, 5 ] )[128X[104X
    [4X[25Xgap>[125X [27XIsParentTransformation( S1, S2, t );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XAsCanonicalTransformation( m );[127X[104X
    [4X[28XIdentityTransformation[128X[104X
    [4X[25Xgap>[125X [27XIsCanonicalTransformation( S1, S2, last );[127X[104X
    [4X[28Xtrue[128X[104X
  [4X[32X[104X
  
