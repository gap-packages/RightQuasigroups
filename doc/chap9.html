<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>GAP (RightQuasigroups) - Chapter 9: Homotopisms, isotopisms and autotopisms</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="generator" content="GAPDoc2HTML" />
<link rel="stylesheet" type="text/css" href="manual.css" />
<script src="manual.js" type="text/javascript"></script>
<script type="text/javascript">overwriteStyle();</script>
</head>
<body class="chap9"  onload="jscontent()">


<div class="chlinktop"><span class="chlink1">Goto Chapter: </span><a href="chap0.html">Top</a>  <a href="chap1.html">1</a>  <a href="chap2.html">2</a>  <a href="chap3.html">3</a>  <a href="chap4.html">4</a>  <a href="chap5.html">5</a>  <a href="chap6.html">6</a>  <a href="chap7.html">7</a>  <a href="chap8.html">8</a>  <a href="chap9.html">9</a>  <a href="chap10.html">10</a>  <a href="chap11.html">11</a>  <a href="chap12.html">12</a>  <a href="chapBib.html">Bib</a>  <a href="chapInd.html">Ind</a>  </div>

<div class="chlinkprevnexttop">&nbsp;<a href="chap0.html">[Top of Book]</a>&nbsp;  <a href="chap0.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap8.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap10.html">[Next Chapter]</a>&nbsp;  </div>

<p id="mathjaxlink" class="pcenter"><a href="chap9_mj.html">[MathJax on]</a></p>
<p><a id="X7A61D9A6797F69A1" name="X7A61D9A6797F69A1"></a></p>
<div class="ChapSects"><a href="chap9.html#X7A61D9A6797F69A1">9 <span class="Heading">Homotopisms, isotopisms and autotopisms</span></a>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X84A22FF682967754">9.1 <span class="Heading">Homotopisms, isotopism and autotopisms of right quasigroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7B9322A17FEE75BE">9.1-1 <span class="Heading">Representing homotopisms in <strong class="pkg">GAP</strong></span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7E3EDDCA7BAFB08D">9.1-2 <span class="Heading">Attributes of homotopisms</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X82A15B907BB84CB6">9.1-3 <span class="Heading">Properties of homotopisms</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X83D6B3A78276416F">9.1-4 <span class="Heading">Creating homotopisms</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X876C9E1F80699761">9.1-5 <span class="Heading">Creating autotopisms</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X827B053B8631FB0A">9.1-6 <span class="Heading">Operations with homotopisms</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X810DE9477E87A0E6">9.1-7 <span class="Heading">Testing homotopism data</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X80BB7E3E7B748897">9.1-8 <span class="Heading">Testing isotopism data</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7E1BBC9D7A1EE535">9.1-9 <span class="Heading">Testing autotopism data</span></a>
</span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X7F1C64D282F3128D">9.2 <span class="Heading">Twists of right quasigroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7BBA721E8434B3FC">9.2-1 <span class="Heading">RightQuasigroupTwist, QuasigroupTwist and LoopTwist</span></a>
</span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X80BDFD068010BD4D">9.3 <span class="Heading">Isotopes of right quasigroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7E9E1BC082A26818">9.3-1 RightQuasigroupIsotope</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X78B2C4877CEBA62C">9.3-2 QuasigroupIsotope</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7D5CBA7E82B1DAC0">9.3-3 LoopIsotope</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7DF4A90B873F25F7">9.3-4 PrincipalLoopIsotope</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X8635F739800C7CFD">9.4 <span class="Heading">Affine right quasigroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7EE71D9A7C68916F">9.4-1 IsAffineRightQuasigroupArithmeticForm</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X85EFAB7078B8BE21">9.4-2 IsAffineQuasigroupArithmeticForm</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X81D7DB9E8579CD24">9.4-3 AffineRightQuasigroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X86A2437087EACE69">9.4-4 AffineQuasigroup</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X8211257E81281568">9.5 <span class="Heading">Right quasigroups up to isotopism</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7AD0041286B5080B">9.5-1 IsotopismDiscriminator</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X79C16888787FF2C6">9.5-2 AreEqualIsotopismDiscriminators</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X82E84144794F4FB7">9.5-3 ArePossiblyIsotopicRightQuasigroups</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X84DDBB8783435C23">9.5-4 IsotopismRightQuasigroups</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7B559DDD8504F74E">9.5-5 IsotopismQuasigroups</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X817BBE5F82383B08">9.5-6 IsotopismLoops</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X8211257E81281568">9.5-7 <span class="Heading">Right quasigroups up to isotopism</span></a>
</span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X82A8ECEC7EE85D13">9.6 <span class="Heading">Autotopism groups of right quasigroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X796F2B38846E7E1B">9.6-1 RQ_NiceMonomorphism</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X7B57D0E9842C1F3F">9.6-2 RQ_NiceMonomorphismInverse</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X835C93C47B557232">9.6-3 RQ_AutotopismGroupByGeneratorsNC</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X86A01F40857DFC21">9.6-4 AutotopismGroup</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap9.html#X7C2FE7D6853A68F9">9.7 <span class="Heading">Topisms using the associated colored digraph</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X82533375830CA142">9.7-1 RQ_Digraph</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap9.html#X8441323F7D66B5DD">9.7-2 RQ_BlissCanonicalLabeling4Morphism</a></span>
</div></div>
</div>

<h3>9 <span class="Heading">Homotopisms, isotopisms and autotopisms</span></h3>

<p><a id="X84A22FF682967754" name="X84A22FF682967754"></a></p>

<h4>9.1 <span class="Heading">Homotopisms, isotopism and autotopisms of right quasigroups</span></h4>

<p>A triple of mappings <span class="Math">t = (f,g,h):(Q_1,\cdot)\to (Q_2,*)</span> between right quasigroups is a <em>homotopism</em> if <span class="Math">f(x)*g(y) = h(x\cdot y)</span> for every <span class="Math">x,y\in Q_1</span>. The right quasigroup <span class="Math">Q_1</span> is the source of <span class="Math">t</span>, <span class="Math">Q_2</span> is the range of <span class="Math">t</span>, and the mappings <span class="Math">f</span>, <span class="Math">g</span>, <span class="Math">h</span> are the components of <span class="Math">t</span>. If <span class="Math">f</span>, <span class="Math">g</span>, <span class="Math">h</span> are also bijections, <span class="Math">t</span> is an <em>isotopism</em>. An isotopism with <span class="Math">(Q_1,\cdot) = (Q_2,*)</span> is an <em>autotopism</em>.</p>

<p><a id="X7B9322A17FEE75BE" name="X7B9322A17FEE75BE"></a></p>

<h5>9.1-1 <span class="Heading">Representing homotopisms in <strong class="pkg">GAP</strong></span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsRightQuasigroupHomotopism</code>( <var class="Arg">object</var> )</td><td class="tdright">(&nbsp;filter&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> or <code class="code">false</code>.</p>

<p>In <strong class="pkg">RightQuasigroups</strong>, homotopisms are represented by a <strong class="pkg">GAP</strong> category <code class="code">IsRightQuasigroupHomotopism</code> that stores attributes and whose objects can be multiplied and inverted. Homotopisms keep track of the source, the range, and the three mappings. If the source is equal to the range, the mappins are stored as parent permutations, otherwise they are stored as parent transformations.</p>

<p><a id="X7E3EDDCA7BAFB08D" name="X7E3EDDCA7BAFB08D"></a></p>

<h5>9.1-2 <span class="Heading">Attributes of homotopisms</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; Source</code>( <var class="Arg">t</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; Range</code>( <var class="Arg">t</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; ComponentOfHomotopism</code>( <var class="Arg">t</var>, <var class="Arg">i</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: the source, range and the <var class="Arg">i</var>th component of a homotopism <var class="Arg">t</var>, respectively. The attributes can be also accessed directly via <code class="code">t!.source</code>, <code class="code">t!.range</code>, <code class="code">t!.f</code>, <code class="code">t!.g</code> and <code class="code">t!.h</code>.</p>

<p>The three components are stored as parent transformations or as parent permutations (when the source equals the range).</p>

<p><a id="X82A15B907BB84CB6" name="X82A15B907BB84CB6"></a></p>

<h5>9.1-3 <span class="Heading">Properties of homotopisms</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsInjective</code>( <var class="Arg">t</var> )</td><td class="tdright">(&nbsp;property&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsSurjective</code>( <var class="Arg">t</var> )</td><td class="tdright">(&nbsp;property&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsBijective</code>( <var class="Arg">t</var> )</td><td class="tdright">(&nbsp;property&nbsp;)</td></tr></table></div>
<p>Returns: <code class="keyw">true</code> or <code class="keyw">false</code></p>

<p>Returns <code class="code">true</code> if (every component of) the homotopism <var class="Arg">t</var> is injective, surjective and bijective, respectively.</p>

<p><a id="X83D6B3A78276416F" name="X83D6B3A78276416F"></a></p>

<h5>9.1-4 <span class="Heading">Creating homotopisms</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; HomotopismRightQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: a homotopism from right quasigroup <var class="Arg">Q1</var> to right quasigroup <var class="Arg">Q2</var> according to the three mappings <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>. Each of the mappings can be a right quasigroup mappings (with source <var class="Arg">Q1</var> and range <var class="Arg">Q2</var>), or a transformation, or a permutation (where the latter only makes sense if <var class="Arg">Q1</var> equals <var class="Arg">Q2</var>). If the optional argument <var class="Arg">isCanonical</var> is set to <code class="code">true</code>, all transformations/permutations are understood as canonical (not parent) transformations/permutations. The function performs an explicit check that the provided data give rise to a homotopism.</p>

<p>We also support other formats of the arguments, namely <code class="code">HomotopismRightQuasigroups( Q, f, g, h[, isCanonical])</code> when <code class="code">Q</code> is both the source and the range, and <code class="code">HomotopismRightQuasigroups( f, g, h )</code> when the three mappings are right quasigroup mappings (which keep track of the source and the range). Note that in the last format the optional argument <var class="Arg">isCanonical</var> is not supported because it is meaningless.</p>

<p>Here is an example of a constructor for a homotopism:</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q1 := ProjectionRightQuasigroup( 3 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q2 := ProjectionRightQuasigroup( 2 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := Transformation( [1,1,2] );; g := Transformation( [2,1,2] );; h := f;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">t := HomotopismRightQuasigroups( Q1, Q2, f, g, h );</span>
&lt;homotopism of right quasigroups&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsRightQuasigroupHomotopism( t ); # category/filter check</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Display( t );</span>
&lt;homotopism of right quasigroups
   source = &lt;associative quandle of size 3&gt;
   range = &lt;associative quandle of size 2&gt;
   f = Transformation( [ 1, 1, 2 ] )
   g = Transformation( [ 2, 1, 2 ] )
   h = Transformation( [ 1, 1, 2 ] )
&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">[ Source( t ), Range( t ) ];</span>
[ &lt;associative quandle of size 3&gt;, &lt;associative quandle of size 2&gt; ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ComponentOfHomotopism( t, 2 ); # the second component, g</span>
Transformation( [ 2, 1, 2 ] )
</pre></div>

<p>And here is an example of a constructor for a homotopism with the same source and range. The homotopism is immediately recognized to be an autotopism since the three given mappings are permutations.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := QuasigroupByFunction( [0..4], function( x,y ) return (x+y) mod 5; end );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := (1,2,3,4,5);; g := (2,4,1,3,5);; h := (3,1,4,2,5);; # +1, +2, +3</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">t := HomotopismRightQuasigroups( Q, f, g, h );</span>
&lt;autotopism of quasigroups&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Display( t );</span>
&lt;autotopism of quasigroups
   source = range = &lt;quasigroup of size 5&gt;
   f = (1,2,3,4,5)
   g = (1,3,5,2,4)
   h = (1,4,2,5,3)
&gt;
</pre></div>

<p><a id="X876C9E1F80699761" name="X876C9E1F80699761"></a></p>

<h5>9.1-5 <span class="Heading">Creating autotopisms</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AutotopismRightQuasigroup</code>( <var class="Arg">Q</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: an autotopism of a right quasigroup <var class="Arg">Q</var> according to the three bijections <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>. The function differs from <code class="code">HomotopismRightQuasigroups( Q, f, g, h )</code> in that it explicitly checks that the provided mappings are bijective. The format of the mappings and the optional argument <code class="code">isCanonical</code> behave as for <code class="code">HomotopismRightQuasigroups</code>.</p>

<p><a id="X827B053B8631FB0A" name="X827B053B8631FB0A"></a></p>

<h5>9.1-6 <span class="Heading">Operations with homotopisms</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IdentityAutotopism</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: the identity autotopism on the right quasigroup <var class="Arg">Q</var>. The identity autotopism can also be obtained by calling <code class="code">HomotopismRightQuasigroups( Q, (), (), () )</code>. Finally, given any homotopism <code class="code">t</code> with source <code class="code">Q</code>, the method <code class="code">One( t )</code> returns the identity autotopism on <code class="code">Q</code>.</p>

<p>Homotopism can be compared, multiplied (composed from left to right) and inverted (if they are bijective).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := QuasigroupByFunction( [0..4], function( x, y ) return (x+y) mod 5; end );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := RightTranslation( Q, 1 );; g := LeftTranslation( Q, 2 );; h := RightTranslation( Q, 3 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">t := HomotopismRightQuasigroups( Q, f, g, h );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Display( t*t );</span>
&lt;autotopism of quasigroups
   source = range = &lt;quasigroup of size 5&gt;
   f = (1,3,5,2,4)
   g = (1,5,4,3,2)
   h = (1,2,3,4,5)
&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Display( t^-1 );</span>
&lt;autotopism of quasigroups
   source = range = &lt;quasigroup of size 5&gt;
   f = (1,5,4,3,2)
   g = (1,4,2,5,3)
   h = (1,3,5,2,4)
&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">One( t );</span>
&lt;identity autotopism&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Display( last );</span>
&lt;identity autotopism on &lt;quasigroup of size 5&gt;&gt;
</pre></div>

<p><a id="X810DE9477E87A0E6" name="X810DE9477E87A0E6"></a></p>

<h5>9.1-7 <span class="Heading">Testing homotopism data</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsHomotopismRightQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsHomotopismQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsHomotopismLoops</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> if the data provided in the arguments gives rise to a homotopism of right quasigroups (quasigroups, loops). Accepts the same type of arguments as the constructor <code class="code">HomotopismRightQuasigroups</code>.</p>

<p><a id="X80BB7E3E7B748897" name="X80BB7E3E7B748897"></a></p>

<h5>9.1-8 <span class="Heading">Testing isotopism data</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsIsotopismRightQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsIsotopismQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsIsotopismLoops</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> if the data provided by in the arguments gives rise to an isotopism of right quasigroups (quasigroups, loops). Accepts the same type of arguments as the constructor <code class="code">HomotopismRightQuasigroups</code>.</p>

<p><a id="X7E1BBC9D7A1EE535" name="X7E1BBC9D7A1EE535"></a></p>

<h5>9.1-9 <span class="Heading">Testing autotopism data</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsAutotopismRightQuasigroups</code>( <var class="Arg">Q</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsAutotopismQuasigroups</code>( <var class="Arg">Q</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsAutotopismLoops</code>( <var class="Arg">Q</var>, <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> if the data provided by in the arguments gives rise to an isotopism of right quasigroups (quasigroups, loops). Accepts the same type of arguments as the constructor <code class="code">HomotopismRightQuasigroups</code> with the same source and range.</p>

<p><a id="X7F1C64D282F3128D" name="X7F1C64D282F3128D"></a></p>

<h4>9.2 <span class="Heading">Twists of right quasigroups</span></h4>

<p>In this section we introduce a natural construction that encompasses isomorphs, isotopes and affine constructions as special cases.</p>

<p>Given a magma <span class="Math">Q</span> and three mappings <span class="Math">f,g,h:Q\to Q</span>, the <em>twist</em> <span class="Math">\mathrm{Tw}(Q,f,g,h)</span> of <span class="Math">Q</span> via <span class="Math">(f,g,h)</span> is defined to be the magma <span class="Math">(Q,*)</span> with multiplication <span class="Math">x*y = h(f(x)g(y))</span>.</p>

<p>If <span class="Math">Q</span> is a right quasigroup, the twist <span class="Math">\mathrm{Tw}(Q,f,g,h)</span> is a right quasigroup iff both <span class="Math">f</span> and <span class="Math">h</span> are bijections of <span class="Math">Q</span>. Moreover, the twist <span class="Math">\mathrm{Tw}(Q,f,g,h)</span> is a quasigroup iff all three <span class="Math">f</span>, <span class="Math">g</span> and <span class="Math">h</span> are bijections of <span class="Math">Q</span>. Finally, if <span class="Math">\mathrm{Tw}(Q,f,g,h)</span> is a quasigroup then it is a loop iff <span class="Math">g^{-1}(f(x)\backslash h^{-1}(x))</span> is equal to <span class="Math">f^{-1}(h^{-1}(x)/g(x))</span> and independent of <span class="Math">x</span>.</p>

<p>For the convenience of the reader, functions that work with twists accept a wide variety of arguments representing mappings. The conventions on arguments here are analogous to those for isomorphs, cf. Section <a href="chap8.html#X7D6B9FFE7F9DEFA2"><span class="RefLink">8.2</span></a>. In more detail:</p>


<ul>
<li><p>The functions are named according to the type of algebra they return, not according to the type of algebra they require as input. For instance, <code class="code">LoopTwist</code> returns a loop but it accepts a quasigroup (or loop).</p>

</li>
<li><p>The arguments <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var> are mandatory and each can be given as a right quasigroup mapping, a transformation or a permutation. The arguments <var class="Arg">f</var> and <var class="Arg">h</var> must always give rise to bijections. If a quasigroup is supposed to be returned, then also <var class="Arg">g</var> must give rise to a bijection. Finally, if a loop is supposed to be returned then <span class="Math">g^{-1}(f(x)\backslash h^{-1}(x))</span> must be equal to <span class="Math">f^{-1}(h^{-1}(x)/g(x))</span> and independent of <span class="Math">x</span>.</p>

</li>
<li><p>If <var class="Arg">f</var> is given as a transformation/permutation, the argument <var class="Arg">Q</var> is also required, and it must be a right quasigroup, quasigroup or loop. The returned algebra will have the same underlying set as <var class="Arg">Q</var>. If <var class="Arg">f</var> is given as a right quasigroup mapping, its source will be used as <var class="Arg">Q</var>.</p>

</li>
<li><p>Any subset of the two optional arguments <var class="Arg">isCanonical</var> and <var class="Arg">constructorStyle</var> can be given.</p>

</li>
<li><p>If the optional argument <var class="Arg">isCanonical</var> is given and set to <code class="code">true</code>, the permutation/transformation <var class="Arg">f</var> is interpreted as a canonical permutation/transformation, else it is by default interpreted as parent permutation/transformation. (See Chapter <a href="chap4.html#X81106768871C276F"><span class="RefLink">4</span></a>.)</p>

</li>
<li><p>See Section <a href="chap2.html#X85C8B48C7BEC8AB6"><span class="RefLink">2.1</span></a> for the optional argument <var class="Arg">constructorStyle</var>.</p>

</li>
</ul>
<p><a id="X7BBA721E8434B3FC" name="X7BBA721E8434B3FC"></a></p>

<h5>9.2-1 <span class="Heading">RightQuasigroupTwist, QuasigroupTwist and LoopTwist</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RightQuasigroupTwist</code>( [<var class="Arg">Q</var>, ]<var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; QuasigroupTwist</code>( [<var class="Arg">Q</var>, ]<var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LoopTwist</code>( [<var class="Arg">Q</var>, ]<var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the twist of the right quasigroup <var class="Arg">Q</var> via <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>, that is, the right quasigroup (quasigroup, loop) on the underlying set of <var class="Arg">Q</var> with multiplication <span class="Math">x*y = h(f(x)g(y))</span>. See above for conventions on the arguments.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := MoufangLoop( 12, 1 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := (1,2,3);; g := Transformation( [3,3,3] );; h := MappingByFunction( Q, Q, x-&gt;x^-1 );; # note various formats</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">T := RightQuasigroupTwist( Q, f, g, h ); # f and h must be bijective </span>
&lt;right quasigroup of size 12&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">QuasigroupTwist( Q,  f, (1,12), h ); # g must be bijective for quasigroups</span>
&lt;quasigroup of size 12&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := RightTranslation( Q, Q.2 )^-1;; g := LeftTranslation( Q, Q.3 )^-1;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">LoopTwist( Q, f, g, (), ConstructorStyle( true, true ) ); # principal loop isotope</span>
&lt;loop of size 12&gt;
</pre></div>

<p><a id="X80BDFD068010BD4D" name="X80BDFD068010BD4D"></a></p>

<h4>9.3 <span class="Heading">Isotopes of right quasigroups</span></h4>

<p>If <span class="Math">t=(f,g,h):(Q,\cdot)\to (Q,*)</span> is an isotopism, then <span class="Math">x*y = h(f^{-1}(x)\cdot g^{-1}(y))</span> for all <span class="Math">x,y\in Q</span>, and <span class="Math">(Q,*)</span> is called an <em>isotope</em> of <span class="Math">(Q,\cdot)</span> via <span class="Math">f</span>, <span class="Math">g</span>, <span class="Math">h</span>. (Note that isotopes are special cases of twists, as introduced in Section <a href="chap9.html#X7F1C64D282F3128D"><span class="RefLink">9.2</span></a>.) The isotope <span class="Math">(Q,*)</span> is a (right) quasigroup iff <span class="Math">(Q,\cdot)</span> is a (right) quasigroup, but an isotope of a loop might not be a loop.</p>

<p>Given a quasigroup <span class="Math">(Q,\cdot,/,\backslash)</span> and <span class="Math">a,b\in Q</span>, the <em>principal loop isotope</em> via <span class="Math">a,b</span> is defined as <span class="Math">(Q,\circ)</span>, where <span class="Math">x\circ y = (x/a)\cdot(b\backslash y)</span>. The principal loop isotope is automatically a loop with neutral element <span class="Math">b\cdot a</span>.</p>

<p><a id="X7E9E1BC082A26818" name="X7E9E1BC082A26818"></a></p>

<h5>9.3-1 RightQuasigroupIsotope</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RightQuasigroupIsotope</code>( [<var class="Arg">Q</var>, ]<var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the isotope of the right quasigroup <var class="Arg">Q</var> via isotopism <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>, that is, the right quasigroup on the underlying set of <var class="Arg">Q</var> with multiplication <span class="Math">x*y = h(f^{-1}(x)g^{-1}(y))</span>. See Section <a href="chap9.html#X7F1C64D282F3128D"><span class="RefLink">9.2</span></a> for conventions on the arguments.</p>

<p><a id="X78B2C4877CEBA62C" name="X78B2C4877CEBA62C"></a></p>

<h5>9.3-2 QuasigroupIsotope</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; QuasigroupIsotope</code>( [<var class="Arg">Q</var>, ]<var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the isotope of the quasigroup <var class="Arg">Q</var> via isotopism <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>, that is, the quasigroup on the underlying set of <var class="Arg">Q</var> with multiplication <span class="Math">x*y = h(f^{-1}(x)g^{-1}(y))</span>. See Section <a href="chap9.html#X7F1C64D282F3128D"><span class="RefLink">9.2</span></a> for conventions on the arguments.</p>

<p><a id="X7D5CBA7E82B1DAC0" name="X7D5CBA7E82B1DAC0"></a></p>

<h5>9.3-3 LoopIsotope</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LoopIsotope</code>( [<var class="Arg">Q</var>, ]<var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>[, <var class="Arg">isCanonical</var>, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the loop isotope of the quasigroup <var class="Arg">Q</var> via isotopism <var class="Arg">f</var>, <var class="Arg">g</var>, <var class="Arg">h</var>, that is, the loop on the underlying set of <var class="Arg">Q</var> with multiplication <span class="Math">x*y = h(f^{-1}(x)g^{-1}(y))</span>. See Section <a href="chap9.html#X7F1C64D282F3128D"><span class="RefLink">9.2</span></a> for conventions on the arguments.</p>

<p>Warning: Unless the constructor style specifies that arguments should be checked, they will not be checked and the returned algebra might not have an identity element despite being declared a loop.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">style := ConstructorStyle( false, false );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P := QuasigroupByFunction( [0..99999], function(x,y) return (x-y) mod 10^5; end, style );</span>
&lt;quasigroup of size 100000&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := (1,10,100,1000,10000,100000);; g := (3,4);; h := ();;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">R := QuasigroupIsotope( P, f, g, h, style );</span>
&lt;quasigroup of size 100000&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">R.1000*R.4;</span>
q97
</pre></div>

<p><a id="X7DF4A90B873F25F7" name="X7DF4A90B873F25F7"></a></p>

<h5>9.3-4 PrincipalLoopIsotope</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; PrincipalLoopIsotope</code>( <var class="Arg">Q</var>, <var class="Arg">a</var>, <var class="Arg">b</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: the loop isotope of the quasigroup <var class="Arg">Q</var> via its elements <var class="Arg">a</var>, <var class="Arg">b</var>. The resulting loop has the same underlying set as <var class="Arg">Q</var> and its neutral element corresponds to <var class="Arg">b</var><code class="code">*</code><var class="Arg">a</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := QuasigroupByFunction( GF(11), \- );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P := PrincipalLoopIsotope( Q, Q.3, Q.4 );</span>
&lt;loop of size 11&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">UnderlyingSetElm( Q.4*Q.3 ) = UnderlyingSetElm( One( P ) );</span>
true
</pre></div>

<p><a id="X8635F739800C7CFD" name="X8635F739800C7CFD"></a></p>

<h4>9.4 <span class="Heading">Affine right quasigroups</span></h4>

<p>Let <span class="Math">Q</span> be a loop, let <span class="Math">f,g</span> be endomorphisms of <span class="Math">Q</span> and <span class="Math">u,v\in Q</span>. Define a new multiplication <span class="Math">*</span> on <span class="Math">Q</span> by <span class="Math">x*y = (f(x)u)(g(y)v)</span> and denote the resulting magma by <span class="Math">\mathrm{Aff}(Q,f,u,g,v)</span>. Then <span class="Math">\mathrm{Aff}(Q,f,u,g,v)</span> is a right quasigroup iff <span class="Math">f</span> is an automorphism of <span class="Math">Q</span> and it is a quasigroup iff both <span class="Math">f</span> and <span class="Math">g</span> are automorphisms of <span class="Math">Q</span>. Analogous comments hold for <span class="Math">\mathrm{Aff}(Q,f,u,v,g)</span>, <span class="Math">\mathrm{Aff}(Q,u,f,g,v)</span> and <span class="Math">\mathrm{Aff}(Q,u,f,v,g)</span>, where the multiplication formula is obtained according to the order of the arguments. For instance, in <span class="Math">\mathrm{Aff}(Q,u,f,g,v)</span> the multiplication is given by <span class="Math">x*y = (uf(x))(g(y)v)</span>.</p>

<p>Any such (right) quasigroup is said to be <em>affine over the loop</em> <span class="Math">Q</span> and the parameters constitute its <em>arithmetic form</em> .</p>

<p>Note that affine right quasigroups are instances of twists of right quasigroups, cf. Section <a href="chap9.html#X7F1C64D282F3128D"><span class="RefLink">9.2</span></a>. Also note that if <span class="Math">Q</span> is an abelian group then all four formulas reduce to <span class="Math">x*y = f(x)g(y)uv</span>, and we can replace <span class="Math">u</span>, <span class="Math">v</span> with a single element <span class="Math">c</span>.</p>

<p>Several different formats of arithmetic forms are supported in <strong class="pkg">RightQuasigroups</strong>:</p>


<ul>
<li><p><code class="code">(n,f,g,c)</code> for four integers such that <code class="code">n</code> is positive, <code class="code">Gcd(n,f)=1</code> (and <code class="code">Gcd(n,g)=1</code> for quasigroups). The multiplication is then defined on <code class="code">[0..n-1]</code> by <code class="code">(f*x + g*y +c) mod n</code>.</p>

</li>
<li><p><code class="code">(F,f,g,c)</code>, where <code class="code">F</code> is a field, <code class="code">f</code> is a nonzero element of <code class="code">F</code> and <code class="code">g</code>, <code class="code">c</code> are elements of <code class="code">F</code> (and <code class="code">g</code> is nonzero for quasigroups). The multiplication is then defined on <code class="code">F</code> by <code class="code">f*x + g*y +c</code>.</p>

</li>
<li><p><code class="code">(G,f,g,c)</code>, where <code class="code">G</code> is an abelian group or an abelian additive group, <code class="code">f</code> is an automorphism of <code class="code">G</code>, <code class="code">g</code> is an endomorphism of <code class="code">G</code>, and <code class="code">c</code> is an element of <code class="code">G</code> (and <code class="code">g</code> is bijective for quasigroups). The multiplication is then defined on <code class="code">G</code> by <code class="code">x^f+y^g+c</code> if <code class="code">G</code> is an additive group and by <code class="code">x^f*y^g*c</code> otherwise.</p>

</li>
<li><p><code class="code">(G,f,u,g,v)</code>, where <code class="code">G</code> is a loop, a group, or an additive group, <code class="code">f</code> is an automorphisms of <code class="code">G</code>, <code class="code">g</code> is an endomorphisms of <code class="code">G</code> and <code class="code">u</code>, <code class="code">v</code> are elements of <code class="code">G</code> (and <code class="code">g</code> is bijective for quasigroups). The multiplication is then defined on <code class="code">G</code> by <code class="code">(x^f+u)+(y^g+v)</code> in the additive case and by <code class="code">(x^f*u)*(y^g*v)</code> otherwise.</p>

</li>
<li><p>The three variations <code class="code">(G,f,u,v,g)</code>, <code class="code">(G,u,f,g,v)</code> and <code class="code">(G,u,f,v,g)</code> are also supported.</p>

</li>
</ul>
<p><a id="X7EE71D9A7C68916F" name="X7EE71D9A7C68916F"></a></p>

<h5>9.4-1 IsAffineRightQuasigroupArithmeticForm</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsAffineRightQuasigroupArithmeticForm</code>( <var class="Arg">arg</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> if the arguments constitute an arithmetic form for an affine right quasigroup, else returns <code class="code">false</code>. See above for the possible formats of arithmetic forms.</p>

<p><a id="X85EFAB7078B8BE21" name="X85EFAB7078B8BE21"></a></p>

<h5>9.4-2 IsAffineQuasigroupArithmeticForm</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsAffineQuasigroupArithmeticForm</code>( <var class="Arg">arg</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> if the arguments constitute an arithmetic form for an affine quasigroup, else returns <code class="code">false</code>. See above for the possible formats of arithmetic forms.</p>

<p><a id="X81D7DB9E8579CD24" name="X81D7DB9E8579CD24"></a></p>

<h5>9.4-3 AffineRightQuasigroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AffineRightQuasigroup</code>( <var class="Arg">arg</var>[, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the affine right quasigroup by the arithmetic form <var class="Arg">arg</var>. See above for the possible formats of arithmetic forms. If a loop <code class="code">G</code> is part of the arithmetic form, the right quasigroup is returned as an isotope of <var class="Arg">G</var>. In all other cases the code first internally creates a suitble right quasigroup <code class="code">G</code>and then returns an isotope of <code class="code">Q</code>.</p>

<p><a id="X86A2437087EACE69" name="X86A2437087EACE69"></a></p>

<h5>9.4-4 AffineQuasigroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AffineQuasigroup</code>( <var class="Arg">arg</var>[, <var class="Arg">constructorStyle</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the affine quasigroup by the arithmetic form <var class="Arg">arg</var>. See above for the possible formats of arithmetic forms. Also see the remark on isotopy under <code class="code">AffineRightQuasigroup</code>.</p>

<p>Here are four examples of affine (right) quasigroups, constructed from various arithmetic forms. First over <code class="code">([0..n-1],+)</code>:</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsAffineRightQuasigroupArithmeticForm( 10, 3, 5, 1 ); # suitable for (3*x+5*y+1) mod 10</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsAffineQuasigroupArithmeticForm( 10, 3, 5, 1 ); # gcd(10,5) &lt;&gt; 1</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := AffineRightQuasigroup( 10, 3, 5, 1 );</span>
&lt;right quasigroup of size 10&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := AffineRightQuasigroup( 100000, 333, 777, 5, ConstructorStyle(false,false) ); # non-index based example</span>
&lt;right quasigroup of size 100000&gt;
</pre></div>

<p>Next over a finite field:</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">F := GF(9);; f := Z(9);; g := Z(9)^3;; c := Z(9)^5;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsAffineQuasigroupArithmeticForm( F, f, g, c ); # suitable for f*x+g*y+c</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AffineQuasigroup( F, f, g, c );</span>
&lt;quasigroup of size 9&gt;
</pre></div>

<p>Next over an abelian group:</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := CyclicGroup(10);; A := AutomorphismGroup( G );; f := A.1;; g := A.2;; c := G.1;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsAffineQuasigroupArithmeticForm( G, f, g, c ); # suitable for x^f*y^g*c</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AffineQuasigroup( G, f, g, c );</span>
&lt;quasigroup of size 10&gt;
</pre></div>

<p>Next over a group:</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := DihedralGroup(12);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := MappingByFunction( G, G, x-&gt;x^(G.1) );; g := MappingByFunction( G, G, x-&gt;x^(G.2) );; u := G.1;; v := G.2;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsAffineQuasigroupArithmeticForm( G, f, u, g, v ); # suitable for (x^f*u)*(y^g*v)</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AffineQuasigroup( G, f, u, g, v ); </span>
&lt;quasigroup of size 12&gt;
</pre></div>

<p>And finally over a loop. Note that the left translations (which are parent permutations) must be converted into loop mappings in the example.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := AutomorphicLoop( 10, 1 );; # inner mappings are automorphisms here</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := AsRightQuasigroupMapping( G, LeftInnerMapping( G, G.2, G.3 ) );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g := f*f;; u := G.1;; v := G.2;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsAffineQuasigroupArithmeticForm( G, u, f, v, g ); # suitable for (u*x^f)*(v*y^g)</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := AffineQuasigroup( G, u, f, v, g ); </span>
&lt;quasigroup of size 10&gt;
</pre></div>

<p><a id="X8211257E81281568" name="X8211257E81281568"></a></p>

<h4>9.5 <span class="Heading">Right quasigroups up to isotopism</span></h4>

<p>We support four methods for calculating isotopisms between loops, quasigroups and right quasigroups <span class="Math">Q_1</span>, <span class="Math">Q_2</span>:</p>


<ul>
<li><p>"via perfect matchings with invariants" (default method for right quasigroups): considers all possible <span class="Math">f</span> that preserve certain invariants of right quasigroups, then completes the isotopism by finding a perfect matching in a bipartite graph,</p>

</li>
<li><p>"via perfect matchings with automorphism group": considers all possible <span class="Math">f</span> modulo the automorphism group of <span class="Math">Q1</span>, then employs perfect matchings as above,</p>

</li>
<li><p>"via domain extension" (for quasigroups and loops only, default method for quasigroups and loops): attempts to find an isotopism <span class="Math">(f,g,h)</span> by iteratively enlarging the domains of <span class="Math">f</span>, <span class="Math">g</span> and <span class="Math">h</span>,</p>

</li>
<li><p>"via principal loop isotopes" (for loops only): constructs principal loop isotopes of <span class="Math">Q1</span> one by one and checks if any one of them is isomrphic to <span class="Math">Q2</span>.</p>

</li>
</ul>
<p><a id="X7AD0041286B5080B" name="X7AD0041286B5080B"></a></p>

<h5>9.5-1 IsotopismDiscriminator</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsotopismDiscriminator</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>Returns: a certain invariant <span class="Math">m</span> of the right quasigroup <var class="Arg">Q</var> that is preserved by isotopisms. (Strictly speaking, only the sorted version of <span class="Math">m</span> is preserved under isotopisms, see <code class="code">AreEqualIsotopismDscriminators</code>.) In more detail, <span class="Math">m</span> is the list <span class="Math">(m_x:x\in Q)</span>, <span class="Math">m_x</span> is the sorted list <span class="Math">(m_{x,y}:y\in Q)</span>, and <span class="Math">m_{x,y}</span> is the number of occurrences of <span class="Math">y</span> in the row indexed by <span class="Math">x</span>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q := RightQuasigroupByCayleyTable([[1,1,1],[2,3,2],[3,2,3]]);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Display(IsotopismDiscriminator( Q ) );</span>
[ [  0,  0,  3 ],
  [  0,  1,  2 ],
  [  0,  1,  2 ] ]
</pre></div>

<p><a id="X79C16888787FF2C6" name="X79C16888787FF2C6"></a></p>

<h5>9.5-2 AreEqualIsotopismDiscriminators</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AreEqualIsotopismDiscriminators</code>( <var class="Arg">D1</var>, <var class="Arg">D2</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> when the two isotopism discriminators <var class="Arg">D1</var>, <var class="Arg">D2</var> calculated via <code class="code">IsotopismDiscriminator</code> are the same. When <code class="code">false</code> is returned, it is guaranteed that the corresponding right quasigroups are not isotopic.</p>

<p><a id="X82E84144794F4FB7" name="X82E84144794F4FB7"></a></p>

<h5>9.5-3 ArePossiblyIsotopicRightQuasigroups</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; ArePossiblyIsotopicRightQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">false</code> if the method determined that <var class="Arg">Q1</var>, <var class="Arg">Q2</var> are not isotopic right quasigroups, based on their isotopism discrininators (and some additional invariants in the case of loops). When <code class="code">true</code> is returned, the two right quasigroups might be isotopic.</p>

<p><a id="X84DDBB8783435C23" name="X84DDBB8783435C23"></a></p>

<h5>9.5-4 IsotopismRightQuasigroups</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsotopismRightQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>[, <var class="Arg">method</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: an isotopism from the right quasigroup <var class="Arg">Q1</var> onto the right quasigroup <var class="Arg">Q2</var>, if it exists, else returns <code class="code">fail</code>. The optional argument <var class="Arg">method</var> must be set to one of the values "via perfect matchings with invariants", "via perfect matchings with automorphism group", "via domain extension" or "via principal loop isotopes". If no method is provided by the user, "via "via domain extension" for loops and quasigroups, while "via perfect matchings with invariants" for right quasigroups.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q1 := RandomRightQuasigroup( 30 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q2 := RightQuasigroupIsotope( Q1, (1,2,3), (10,20,30), (4,30) );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">t := IsotopismRightQuasigroups( Q1, Q2 );</span>
&lt;isotopism of right quasigroups&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q3 := RightQuasigroupIsotope( Q1, t!.f, t!.g, t!.h );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">MultiplicationTable( Q2 ) = MultiplicationTable( Q3 );</span>
true
</pre></div>

<p><a id="X7B559DDD8504F74E" name="X7B559DDD8504F74E"></a></p>

<h5>9.5-5 IsotopismQuasigroups</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsotopismQuasigroups</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>[, <var class="Arg">method</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: an isotopism from the quasigroup <var class="Arg">Q1</var> onto the quasigroup <var class="Arg">Q2</var>, if it exists, else returns <code class="code">fail</code>. The only difference from <code class="code">IsotopismRightQuasigroups</code> is that the arguments <var class="Arg">Q1</var>, <var class="Arg">Q2</var> must be quasigroups.</p>

<p><a id="X817BBE5F82383B08" name="X817BBE5F82383B08"></a></p>

<h5>9.5-6 IsotopismLoops</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsotopismLoops</code>( <var class="Arg">Q1</var>, <var class="Arg">Q2</var>[, <var class="Arg">method</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: an isotopism from the loop <var class="Arg">Q1</var> onto the loopp <var class="Arg">Q2</var>, if it exists, else returns <code class="code">fail</code>. The only difference from <code class="code">IsotopismRightQuasigroups</code> is that the arguments <var class="Arg">Q1</var>, <var class="Arg">Q2</var> must be loops.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q1 := MoufangLoop( 32, 10 );</span>
MoufangLoop( 32, 10 )
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q2 := LoopIsomorph( Q1, (3,4) );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Q3 := PrincipalLoopIsotope( Q2, Q2.10, Q2.20 );; # a loop isotopic to Q1</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsotopismLoops( Q1, Q3 ); </span>
&lt;isotopism of loops&gt;
</pre></div>

<p><a id="X8211257E81281568" name="X8211257E81281568"></a></p>

<h5>9.5-7 <span class="Heading">Right quasigroups up to isotopism</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RightQuasigroupsUpToIsotopism</code>( <var class="Arg">ls</var>[, <var class="Arg">method</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; QuasigroupsUpToIsotopism</code>( <var class="Arg">ls</var>[, <var class="Arg">method</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LoopsUpToIsotopism</code>( <var class="Arg">ls</var>[, <var class="Arg">method</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: a sublist of <code class="code">ls</code> consisting of all right quasigroups (quasigroups, loops) in <code class="code">ls</code> up to isotopism. In case of loops, if the optional argument <var class="Arg">viaPrincipalLoopIsotopes</var> is set to <code class="code">true</code>, uses a method based on principal loop isotopes.</p>

<p><a id="X82A8ECEC7EE85D13" name="X82A8ECEC7EE85D13"></a></p>

<h4>9.6 <span class="Heading">Autotopism groups of right quasigroups</span></h4>

<p>The autotopism group of a right quasigroup consist of abstract homotopism <strong class="pkg">GAP</strong> objects. While the group operations are defined for them, the computation of size, center and other important group theoretical concepts is very slow. In this case, <strong class="pkg">GAP</strong> recommends to use a <code class="code">NiceMonomorphism</code> into a group <span class="Math">G</span>, whose representation allows fast generic methods. For autotopisms of a right quasigroup <span class="Math">Q</span>, <span class="Math">G</span> is the symmetric group on <span class="Math">3n</span> points, where <span class="Math">n</span> is the size of the parent of <span class="Math">Q</span>. If the triple <span class="Math">(f,g,h)</span> defines an autotopism of <span class="Math">Q</span>, then its nice monomorphic image acts on <span class="Math">\{1,\ldots,n\}</span> as the parent permutation of <span class="Math">f</span>, on <span class="Math">\{n+1,\ldots,2n\}</span> as the conjugate of the parent permutation of <span class="Math">g</span>, and on <span class="Math">\{2n+1,\ldots,3n\}</span> as the conjugate of the parent permutation of <span class="Math">h</span>.</p>

<p><a id="X796F2B38846E7E1B" name="X796F2B38846E7E1B"></a></p>

<h5>9.6-1 RQ_NiceMonomorphism</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RQ_NiceMonomorphism</code>( <var class="Arg">t</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: a permutation of degree <span class="Math">3n</span>, where <span class="Math">n</span> is the size of the parent right quasigroup of the source of <var class="Arg">t</var>.</p>

<p>The input is a <code class="code">HomotopismRightQuasigroups</code> object. This map is a nice monomorphism for this category.</p>

<p><a id="X7B57D0E9842C1F3F" name="X7B57D0E9842C1F3F"></a></p>

<h5>9.6-2 RQ_NiceMonomorphismInverse</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RQ_NiceMonomorphismInverse</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the inverse function <span class="Math">f</span> of the nice monomorphism <code class="code">HomotopismRightQuasigroups</code> objects whose source is the right quasigroup <var class="Arg">Q</var>. The function <span class="Math">f</span> maps permutations of degree <span class="Math">3n</span> to isotopisms of <var class="Arg">Q</var>, where <span class="Math">n</span> is the size of the parent of <var class="Arg">Q</var>.</p>

<p><a id="X835C93C47B557232" name="X835C93C47B557232"></a></p>

<h5>9.6-3 RQ_AutotopismGroupByGeneratorsNC</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RQ_AutotopismGroupByGeneratorsNC</code>( <var class="Arg">Q</var>, <var class="Arg">gens</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Returns: a group consisting of <code class="code">HomotopismRightQuasigroups</code> objects. This group has a a nice monomorphism to a permutation group of degree <span class="Math">3n</span> where <span class="Math">n</span> is the order of the parent group of <var class="Arg">Q</var>.</p>

<p><a id="X86A01F40857DFC21" name="X86A01F40857DFC21"></a></p>

<h5>9.6-4 AutotopismGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AutotopismGroup</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>Returns: the autotopism group of a loop <var class="Arg">Q</var>. Note: There is no generic method implemented yet for right quasigroups and quasigroups.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">q := RightBolLoop( 16, 3 );</span>
RightBolLoop( 16, 3 )
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ag := AutotopismGroup( q );</span>
&lt;group with 5 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size( ag );</span>
768
</pre></div>

<p><a id="X7C2FE7D6853A68F9" name="X7C2FE7D6853A68F9"></a></p>

<h4>9.7 <span class="Heading">Topisms using the associated colored digraph</span></h4>

<p>Let <span class="Math">(M,*)</span> be a magma of order <span class="Math">n</span>, <span class="Math">M=\{m_1,\ldots,m_n\}</span>. Define the set <span class="Math">T</span>, which consists of triples <span class="Math">\{i,j,k\}</span>, <span class="Math">1\leq i \leq n &lt; j \leq 2n &lt; k \leq 3n</span>, such that <span class="Math">\{i,j,k\} \in T</span> if and only if <span class="Math">m_i*m_{j-n} = m_{k-2n}</span>. Clearly, <span class="Math">|T|=n^2</span>. Define <span class="Math">V=\{1,\ldots,3n\} \cup T</span> and <span class="Math">E=\{(i,t) : 1\leq i \leq 3n, i \in t\in T\}</span>. Then <span class="Math">\Gamma=(V,E)</span> is a directed graph on <span class="Math">3n+n^2</span> vertices. We call <span class="Math">\Gamma</span> the <em>digraph associated to <span class="Math">M</span></em>. If we define the color classes <span class="Math">\{1,\ldots,n\}</span>, <span class="Math">\{n+1,\ldots,2n\}</span>, <span class="Math">\{2n+1,\ldots,3n\}</span> and <span class="Math">T</span> on the vertices of <span class="Math">\Gamma</span>, then we speak of the <em>colored digraph associated to</em> <span class="Math">M</span>.</p>

<p>Two colored digraphs are isomorphic, if there is a bijection between their vertices, which preserves adjacency and colors. Two magmas are isotopic if and only if their associated colored digraphs are isomorphic. There is a one-to-one correspondance between autotopisms of a magma and the (color preserving) automorphisms of the associated colored digraph.</p>

<p>We use the BLISS interface of the <strong class="pkg">Digraphs</strong> package to compute isomorphisms and automorphisms of colored digraphs. As a by-product of Brendon McKay's graph automorphism algorithm, we obtain a <em>canonical labeling</em> of <span class="Math">\Gamma</span>. Canonical labelings may speed up the search for isomorphisms between colored digraphs. However, canonical labeling of graphs are not uniquely defined, they may depend on the software version and the hardware specifications.</p>

<p><a id="X82533375830CA142" name="X82533375830CA142"></a></p>

<h5>9.7-1 RQ_Digraph</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RQ_Digraph</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>Returns: the colored directed graph on <span class="Math">3n+n^2</span> vertices, where <span class="Math">n=|Q|</span>.</p>

<p><a id="X8441323F7D66B5DD" name="X8441323F7D66B5DD"></a></p>

<h5>9.7-2 RQ_BlissCanonicalLabeling4Morphism</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RQ_BlissCanonicalLabeling4Morphism</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RQ_BlissCanonicalLabeling4Topism</code>( <var class="Arg">Q</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>Returns: a permutation of degree <span class="Math">n</span> or <span class="Math">3n</span>, where <span class="Math">n=|Q|</span>.</p>

<p>Let <span class="Math">Q,S</span> be two right quasigroups and <span class="Math">u,v</span> the permutations returned by <code class="code">RQ_BlissCanonicalLabeling4Morphism</code>. Let <span class="Math">Q'</span> be the isomorph of <span class="Math">Q</span> via <span class="Math">uv^{-1}</span>. Then <span class="Math">Q</span> and <span class="Math">S</span> are isomorphic if and only if <span class="Math">Q'</span> and <span class="Math">S</span> have the same multiplication table. Similarly, let <span class="Math">w,z</span> be the permutations returned by <code class="code">RQ_BlissCanonicalLabeling4Topism</code>. The map <span class="Math">wz^{-1}</span> induces three mappings <span class="Math">g,f,h:Q\to S</span>. Let <span class="Math">Q'</span> be the right quasigroup isotope of <span class="Math">Q</span> w.r.t. the mappings <span class="Math">f,g,h</span>. Then <span class="Math">Q</span> and <span class="Math">S</span> are isotopic if and only if <span class="Math">Q'</span> and <span class="Math">S</span> have the same multiplication table.</p>


<div class="chlinkprevnextbot">&nbsp;<a href="chap0.html">[Top of Book]</a>&nbsp;  <a href="chap0.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap8.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap10.html">[Next Chapter]</a>&nbsp;  </div>


<div class="chlinkbot"><span class="chlink1">Goto Chapter: </span><a href="chap0.html">Top</a>  <a href="chap1.html">1</a>  <a href="chap2.html">2</a>  <a href="chap3.html">3</a>  <a href="chap4.html">4</a>  <a href="chap5.html">5</a>  <a href="chap6.html">6</a>  <a href="chap7.html">7</a>  <a href="chap8.html">8</a>  <a href="chap9.html">9</a>  <a href="chap10.html">10</a>  <a href="chap11.html">11</a>  <a href="chap12.html">12</a>  <a href="chapBib.html">Bib</a>  <a href="chapInd.html">Ind</a>  </div>

<hr />
<p class="foot">generated by <a href="https://www.math.rwth-aachen.de/~Frank.Luebeck/GAPDoc">GAPDoc2HTML</a></p>
</body>
</html>
